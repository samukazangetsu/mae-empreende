<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/css/style.css">
    <title>Perfil</title>
</head>

<body>
    <nav class="navbar text-start">
        <div id="menu" class="ms-5 me-5 p-2 container-fluid">
            <h1 class="text-start nav-item"><a id="logo" href="/" class="navbar-brand">Mãe Empreende</a></h1>
            <form id="search" class="nav-item">
                <input class="form-control me-2 container" type="search" placeholder="Buscar produtos"
                    aria-label="Search">
            </form>
            <div id="icones" class="nav-item container">
                <a href="">
                    <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 35 35" fill="none">
                        <path
                            d="M29.1667 30.625V27.7083C29.1667 26.1612 28.5521 24.6775 27.4582 23.5835C26.3642 22.4896 24.8805 21.875 23.3334 21.875H11.6667C10.1196 21.875 8.63588 22.4896 7.54192 23.5835C6.44796 24.6775 5.83337 26.1612 5.83337 27.7083V30.625"
                            stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path
                            d="M17.5 16.0417C20.7216 16.0417 23.3333 13.43 23.3333 10.2083C23.3333 6.98667 20.7216 4.375 17.5 4.375C14.2783 4.375 11.6666 6.98667 11.6666 10.2083C11.6666 13.43 14.2783 16.0417 17.5 16.0417Z"
                            stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </a>
                <a href="">
                    <svg xmlns="http://www.w3.org/2000/svg" width="27" height="27" viewBox="0 0 27 27" fill="none"
                        class="ms-3">
                        <path
                            d="M10.0907 26C10.7183 26 11.2271 25.467 11.2271 24.8095C11.2271 24.152 10.7183 23.619 10.0907 23.619C9.46311 23.619 8.95435 24.152 8.95435 24.8095C8.95435 25.467 9.46311 26 10.0907 26Z"
                            stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path
                            d="M22.5905 26C23.2181 26 23.7268 25.467 23.7268 24.8095C23.7268 24.152 23.2181 23.619 22.5905 23.619C21.9629 23.619 21.4541 24.152 21.4541 24.8095C21.4541 25.467 21.9629 26 22.5905 26Z"
                            stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path
                            d="M1 1H5.54545L8.59091 16.9405C8.69482 17.4886 8.97944 17.9809 9.39494 18.3313C9.81044 18.6817 10.3303 18.8678 10.8636 18.8571H21.9091C22.4424 18.8678 22.9623 18.6817 23.3778 18.3313C23.7933 17.9809 24.0779 17.4886 24.1818 16.9405L26 6.95238H6.68182"
                            stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </a>
            </div>
        </div>
    </nav>
    <div class="conteudo card m-5 p-5">
        <div class="container foto align-self-end">
            <div class="row">
                <div class="col-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" width="188" height="191" viewBox="0 0 188 191" fill="none">
                        <g clip-path="url(#clip0_38_1701)">
                            <path
                                d="M188 95.4583C188 148.178 145.869 193.219 94.0102 190.917C39.8303 188.51 -1.04772 147.046 0.0204609 95.4583C1.11257 42.7493 42.1017 0 94.0102 0C145.919 0 188 42.7371 188 95.4583Z"
                                fill="#52C1FF" />
                            <path
                                d="M94.0189 39.9364H94.0001C54.4107 39.9364 45.0193 88.0597 69.9566 107.132L94.0001 95.5L94.0155 95.507L94.0189 95.5087L118.045 107.132C142.757 88.2299 133.866 39.952 94.0189 39.9364Z"
                                fill="black" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M142.554 134.851L148.691 151.064H39.3091L45.4464 134.853C46.1958 132.873 47.3815 131.094 48.9125 129.652C50.4436 128.21 52.2793 127.144 54.279 126.534L76.9091 121.052V106.668C81.7646 114.301 88.3873 117.908 94 119.807C99.6126 117.908 106.235 114.301 111.091 106.668V121.051L133.721 126.532C135.721 127.142 137.556 128.209 139.087 129.651C140.618 131.093 141.804 132.872 142.554 134.851Z"
                                fill="white" />
                            <path
                                d="M123.054 123.282L118.455 121.695C114.487 137.82 112.8 148.749 93.9999 148.749C75.1999 148.749 73.513 137.822 69.5445 121.695L64.9454 123.282L56.3999 151.064H131.6L123.054 123.282Z"
                                fill="black" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M74.824 118.444C75.2757 118.406 75.7237 118.552 76.0696 118.85C76.4154 119.147 76.6307 119.572 76.6681 120.031C76.7861 121.476 77.6372 123.278 79.1583 125.32C80.6486 127.322 82.6448 129.366 84.7521 131.264C87.6417 133.842 90.7025 136.216 93.9129 138.367C96.7414 136.466 100.891 133.398 104.461 130.078C106.449 128.229 108.209 126.345 109.46 124.577C110.746 122.759 111.323 121.299 111.323 120.254C111.323 119.793 111.503 119.351 111.824 119.026C112.144 118.7 112.579 118.517 113.032 118.517C113.486 118.517 113.92 118.7 114.241 119.026C114.562 119.351 114.742 119.793 114.742 120.254C114.742 122.412 113.643 124.615 112.236 126.603C110.794 128.642 108.845 130.708 106.769 132.641C102.612 136.508 97.7515 140.008 94.8495 141.892L93.9573 142.47L93.0515 141.92C91.5475 141.007 86.8783 137.819 82.4842 133.863C80.2863 131.884 78.1123 129.672 76.434 127.418C74.783 125.204 73.4602 122.752 73.2619 120.318C73.2246 119.859 73.3682 119.404 73.6611 119.052C73.954 118.701 74.3724 118.482 74.824 118.444Z"
                                fill="black" />
                            <path
                                d="M93.9111 147.591C93.9111 147.591 100.836 143.533 100.836 139.046C100.836 134.561 93.9111 134.672 93.9111 138.096C93.9111 134.672 86.9858 134.559 86.9858 139.392C86.9858 144.222 93.9111 147.591 93.9111 147.591Z"
                                fill="black" />
                            <path
                                d="M119.636 78.1364H117.927V78.0999C117.928 76.3375 117.892 74.5753 117.82 72.8144C117.289 72.8855 116.754 72.9232 116.218 72.9273C110.129 72.9273 105.113 68.6315 104.362 63.0786C101.447 68.8763 94.8495 72.9273 87.1637 72.9273C80.3804 72.9273 74.4549 69.3972 71.153 64.4139C70.2574 68.5638 70.0831 73.2433 70.0728 78.0999V78.1364H68.3637C66.6546 78.1364 64.9456 80.0655 64.9456 81.9946C64.9456 87.3617 66.4222 94.3748 72.0861 95.3698C76.2597 111.174 86.1314 117.146 94.0001 119.809C101.869 117.146 111.74 111.174 115.914 95.3698C121.578 94.3766 123.055 87.3617 123.055 81.9946C123.055 80.0655 121.346 78.1364 119.636 78.1364Z"
                                fill="white" />
                            <path
                                d="M105.953 81.6091C105.953 80.6881 105.593 79.8048 104.952 79.1535C104.311 78.5022 103.442 78.1364 102.535 78.1364H102.525C102.527 78.1728 102.535 78.2075 102.535 78.244C102.535 79.1632 102.176 80.045 101.538 80.6959C100.899 81.3469 100.032 81.714 99.1272 81.7167C99.1412 82.6364 99.5143 83.5127 100.164 84.1529C100.814 84.7931 101.688 85.1447 102.593 85.1304C103.498 85.1161 104.361 84.7371 104.991 84.0768C105.621 83.4164 105.967 82.5287 105.953 81.6091Z"
                                fill="black" />
                            <path
                                d="M85.4546 100.709H102.545C102.545 100.709 102.545 105.918 94 105.918C85.4546 105.918 85.4546 100.709 85.4546 100.709Z"
                                fill="black" />
                            <path
                                d="M88.8727 81.6091C88.8727 80.6881 88.5126 79.8048 87.8716 79.1535C87.2305 78.5022 86.3611 78.1364 85.4546 78.1364H85.4443C85.4443 78.1746 85.4546 78.2093 85.4546 78.2457C85.4546 79.165 85.0958 80.0467 84.457 80.6977C83.8182 81.3486 82.9514 81.7157 82.0466 81.7185C82.0609 82.6381 82.4342 83.5143 83.0844 84.1544C83.7345 84.7944 84.6083 85.1458 85.5135 85.1313C86.4187 85.1168 87.2812 84.7375 87.9111 84.077C88.5411 83.4165 88.887 82.5287 88.8727 81.6091Z"
                                fill="black" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M111.091 112.221C106.066 118.425 99.905 121.62 94.5914 123.421L94.0514 123.603L93.5096 123.419C88.208 121.624 81.9801 118.425 76.9092 112.108V106.708C79.768 111.228 83.7355 114.914 88.4216 117.404C90.2239 118.41 92.1073 119.258 94.0514 119.939C96.7141 118.995 99.5786 117.672 102.358 115.715C105.852 113.344 108.825 110.264 111.091 106.668V112.221Z"
                                fill="black" />
                        </g>
                        <defs>
                            <clipPath id="clip0_38_1701">
                                <rect width="188" height="191" fill="white" />
                            </clipPath>
                        </defs>
                    </svg>
                </div>
                <div class="col-sm text-start">
                    <h2 id="nome-principal">Furina Pereira</h2>
                    <h6>Dados Pessoais</h6>
                </div>
                <div class="col-sm text-end">
                    <h5>Editar Dados</h5>
                </div>
            </div>
        </div>
        <div class="container mt-5">
            <form id="profileForm">
                <input class="input-label-usuario m-4" type="text" id="nome" placeholder="Nome Completo" required>

                <input class="input-label-usuario m-4" type="text" id="cpf" placeholder="CPF" required>

                <input class="input-label-usuario m-4" type="text" id="telefone" placeholder="Número do Celular"
                    required>

                <input class="input-label-endereco m-4" type="text" id="cep" placeholder="CEP" required>

                <input class="input-label-endereco m-4" type="text" id="logradouro" placeholder="Logradouro" required>

                <input class="input-label-endereco m-4" type="number" id="numero" placeholder="Número" required>

                <input class="input-label-endereco m-4" type="text" id="complemento" placeholder="Complemento" required>

                <input class="input-label-endereco m-4" type="text" id="bairro" placeholder="Bairro" required>

                <input class="input-label-endereco m-4" type="text" id="cidade" placeholder="Cidade" required>

                <input class="input-label-endereco m-4" type="text" id="estado" placeholder="Estado" required>

                <input class="input-label-usuario m-4" type="email" id="email" placeholder="Email" required>

                <div class="container text-center">
                    <button id="btn" class="primary primary-button p-2 m-5" type="button"
                        onclick="atualizarPerfil()"><span>Salvar</span></button>
                </div>

                <div class="container text-center">
                    <a href="/cadastro-produto">
                        <button id="btn" class="secondary secondary-button p-1" type="button"
                        onclick=""><span>Cadastrar produtos</span></button>
                    </a>
                </div>
            </form>
        </div>
    </div>
    <script>
        const getJson = function () {
            const buscarData = function (url, inputs, atualizarNome) {
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.open('GET', url, true);
                xmlhttp.responseType = 'json';
                xmlhttp.onload = function () {
                    var status = xmlhttp.status;
                    if (status === 200) {
                        atualizarCampos(xmlhttp.response, inputs);
                        if(atualizarNome){
                            document.getElementById("nome-principal").innerHTML = xmlhttp.response['nome'];
                        }
                    } else {
                        console.log(status, xmlhttp.response);
                    }
                }
                xmlhttp.send();
            }

            var url = "/usuario";
            var urlEndereco = "/endereco";

            const inputsUsuario = document.getElementsByClassName("input-label-usuario");
            const inputsEndereco = document.getElementsByClassName("input-label-endereco");
            

            buscarData(url, inputsUsuario, true);
            buscarData(urlEndereco, inputsEndereco, false);



            function atualizarCampos(arr, inputs) {
                for (const input of inputs) {
                    input.value = arr[input.id] ?? '';
                }
            }
        }
        getJson();    
    </script>
    <script>
        const atualizarPerfil = async function () {
            var xmlhttp = new XMLHttpRequest();
            var urlUsuario = "/usuario";
            var urlEndereco = "/endereco";

            xmlhttp.onload = function () {
                var status = xmlhttp.status;
                if (status === 200) {
                    getJson();
                } else {
                    console.log(status, xmlhttp.response);
                }
            }
            const inputsUsuario = document.getElementsByClassName("input-label-usuario");
            const inputsEndereco = document.getElementsByClassName("input-label-endereco");
            const enviarData = function (inputs, url) {
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.open('PUT', url, true);
                xmlhttp.setRequestHeader('Content-type', 'application/json; charset=utf-8');
                var data = {};
                for (const input of inputs) {
                    data[input.id] = input.value.trim();
                }

                var json = JSON.stringify(data);
                xmlhttp.send(json);
            }

            await enviarData(inputsEndereco, urlEndereco);
            await enviarData(inputsUsuario, urlUsuario);
            window.alert("Dados atualizados com sucesso!");
        }
    </script>
</body>

</html>